@use './loading.module.scss';
@use '../style.scss' as *;

.glitch {
  @extend .glitch;
  cursor: pointer;
  overflow: hidden;
  position: relative;
  background-color: #000000; /* âœ… ì™„ì „ ë¸”ë™ */
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-blend-mode: normal;
  filter: contrast(1.3) brightness(0.95);
  transition:
    opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1),
    transform 0.4s cubic-bezier(0.4, 0, 0.2, 1),
    filter 0.3s ease-in-out;
  isolation: isolate;

  /* ğŸï¸ CRT ìˆ˜í‰ ì£¼ì‚¬ì„ ë§Œ ìœ ì§€ (ëŒ€ê°ì„  ë¹› ì™„ì „ ì œê±°) */
  &::before {
    content: "";
    position: absolute;
    inset: 0;
    background: repeating-linear-gradient(
      0deg, /* âœ… ìˆ˜í‰ ë°©í–¥ë§Œ */
      rgba(255, 255, 255, 0.015) 0px,
      rgba(255, 255, 255, 0.015) 1px,
      transparent 2px,
      transparent 4px
    );
    mix-blend-mode: normal; /* âœ… êµì°¨ ë°˜ì‚¬ ì œê±° */
    opacity: 0.12; /* âœ… ì‚´ì§ë§Œ ë³´ì´ê²Œ */
    pointer-events: none;
    animation: crt-scan 6s linear infinite, crt-noise 1s steps(5) infinite;
    z-index: 1;
  }

  /* ğŸŒˆ RGB ì±„ë„ ë¶„ë¦¬ íš¨ê³¼ */
  .channel {
    position: absolute;
    inset: 0;
    mix-blend-mode: screen;
    opacity: 0;
    transition: opacity 0.15s ease-in-out, transform 0.15s ease-in-out;
    z-index: 2;

    &.r {
      background-color: rgba(255, 0, 100, 0.1);
      transform: translate(2px, -1px);
    }
    &.g {
      background-color: rgba(0, 255, 150, 0.1);
      transform: translate(-1.5px, 1px);
    }
    &.b {
      background-color: rgba(50, 150, 255, 0.1);
      transform: translate(1px, -0.5px);
    }

    &.active {
      opacity: 0.35;
      filter: brightness(1.3) contrast(1.2);
    }
  }

  /* âš¡ í´ë¦­ ë˜ëŠ” í˜ì´ì§€ ì „í™˜ ì‹œ í˜ì´ë“œ */
  &.fadeOut {
    opacity: 0;
    transform: scale(1.05);
    pointer-events: none;
    filter: brightness(1.1);

    & + * {
      overflow: hidden;
    }

    .channel {
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
    }

    &::before {
      opacity: 0;
      transform: scale(1.1);
      transition: all 0.6s ease-in-out;
    }
  }

  /* ğŸ’« Hover ì‹œ ì•½ê°„ì˜ ê¸€ë¦¬ì¹˜ ì›€ì§ì„ */
  &:hover {
    &::before {
      filter: brightness(1.05) saturate(1.15);
    }

    .channel {
      &.r { transform: translate(3px, -1.5px); }
      &.g { transform: translate(-2px, 1px); }
      &.b { transform: translate(1.5px, -1px); }
    }
  }
}

/* âœ… CRT ìˆ˜í‰ ìŠ¤ìº” íš¨ê³¼ */
@keyframes crt-scan {
  0% { background-position-y: 0; }
  100% { background-position-y: 100%; }
}

/* âœ… ë¯¸ì„¸í•œ ì§€ì§€ì§ ë…¸ì´ì¦ˆ ì›€ì§ì„ */
@keyframes crt-noise {
  0%, 100% { opacity: 0.1; transform: translate(0, 0); }
  20% { opacity: 0.14; transform: translate(1px, -1px); }
  40% { opacity: 0.12; transform: translate(-1px, 1px); }
  60% { opacity: 0.16; transform: translate(0.5px, -0.5px); }
  80% { opacity: 0.1; transform: translate(-0.5px, 0.5px); }
}

/* âœ… Fade ì¤‘ ë°°ê²½ ìœ ì§€ */
:global(body) {
  transition: background-color 0.4s cubic-bezier(0.4, 0, 0.2, 1);

  &:has(.fadeOut) {
    overflow: hidden;
    background-color: #000;
  }
}

:global(#root) {
  overflow: hidden;
}